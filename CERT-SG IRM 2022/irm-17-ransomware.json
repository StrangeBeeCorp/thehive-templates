{"_id":"~3932266712","_type":"CaseTemplate","_createdBy":"florian@strangebee.com","_updatedBy":"florian@strangebee.com","_createdAt":1670510248030,"_updatedAt":1670519504764,"name":"IRM-17-Ransomware","displayName":"Ransomware (CERT-SG IRM17)","titlePrefix":"","description":"This Incident Response Methodology is a cheat sheet dedicated to handlers investigating on a precise security issue.\n\n**WHO SHOULD USE IRM SHEETS?**\n\n- Administrators\n- Security Operation Center\n- CISOs and deputies\n- CERTs (Computer Emergency Response Team)\n\n**Remember: If you face an incident, follow IRM, take notes. Keep calm and contact your business line’s Incident Response team or CERT immediately if needed.**\n\nReferences:\n→ IRM CERT SG: https://github.com/certsocietegenerale/IRM","severity":4,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"_id":"~3481739384","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504760,"title":"Containment","group":"default","description":"## OBJECTIVE: MITIGATE THE ATTACK’S EFFECTS ON THE TARGETED ENVIRONMENT.\n\n▪ Make a public statement as soon as possible based on the communication template elaborated in the preparation phase.\n▪ Follow the posture defined in the preparation phase.\n▪ Send the undetected samples to your endpoint security provider and/or private sandboxes.\n▪ Send the uncategorized malicious URL, domain names and IP to your perimetric security provider.\n▪ Block traffic to C2s.\n▪ Block any IP detected as used by attackers.\n▪ Isolate compromised VLAN, interconnexion, entities, regions, partners or Internet.\n▪ Disable accounts compromised/created by attackers.\n▪ Disconnect all computers that have been detected as compromised from the network.\n  o You could isolate with our EDR and shut down internet just keeping your EDR connections up.\n▪ If you cannot isolate computers, disconnect/cancel the shared drives.\n  o ( `NET USE x: \\\\unc\\path\\ /DELETE` )\n\n> Monitor ransomware threat actor websites and Internet to find if there is any dataleak publication related to the ransomware compromise.","status":"Waiting","flag":false,"order":2,"extraData":{}},{"_id":"~3604590696","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504762,"title":"Recovery","group":"default","description":"## OBJECTIVE: RESTORE THE SYSTEM TO NORMAL OPERATIONS\n\n1. Update antivirus signatures for identified malicious binaries to be blocked.\n2. Ensure that no malicious binaries are present on the systems before reconnecting them.\n3. Ensure that the network traffic is back to normal.\n4. Restore user’s documents from backups.\n\nPrioritize your recovery plan based on your DRP (disaster recovery plan).\n\n---\n**All of these steps shall be made in a step-by-step manner and with technical monitoring.**\n▪ Verify that backups are not compromised: only restore from a backup if you are very confident that the backup and the device you are connecting it to are clean.\nOR\n▪ Reimage the computer with a clean install.\n▪ Reset credentials including passwords (especially for administrator and other system accounts).\n\n---\n**Monitor network traffic to identify if any infection remains.**\n\n---\n**If possible, apply geo-filtering on firewalls to block illegitimate foreign country traffic.**\n\n---\n**Maintain the monitoring ransomware threat actor websites and Internet to find if there is any data\nleak publication related to the ransomware compromise.**","status":"Waiting","flag":false,"order":4,"extraData":{}},{"_id":"~3604594792","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504763,"title":"Lessons learned","group":"default","description":"## OBJECTIVE: DOCUMENT THE INCIDENT’S DETAILS, DISCUSS LESSONS LEARNED, AND ADJUST PLANS AND DEFENSES\n\n**Report**\nAn incident report should be written and made available to all the stakeholders.\n\nThe following themes should be described:\n▪ Initial cause of the infection\n▪ Actions and timelines of every important event\n▪ What went right\n▪ What went wrong\n▪ Incident cost\n▪ Indicators of compromise\n\n---\n**Capitalize**\nActions to improve malware and network intrusion detection processes should be defined to capitalize on this experience.","status":"Waiting","flag":false,"order":5,"extraData":{}},{"_id":"~3727532200","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504758,"title":"Preparation","group":"default","description":"## OBJECTIVE: ESTABLISH CONTACTS, DEFINE PROCEDURES, GATHER INFORMATION TO SAVE TIME DURING AN INCIDENT.\n\n**A good knowledge of :**\n▪  The usual operating systems security policies is needed.\n▪  The usual users’ profile policies is needed.\n▪  Architecture, VLAN segmentation and interconnexions:\n  o Have the capability to isolate entities, regions, partners or Internet.\n**Ensure that the endpoint and perimetric (email gateway, proxy caches) security products are up to date.**\n\n---\n**Deploy an EDR solution on endpoints and servers:**\n▪  This tool became one of the cornerstones of the incident response in case of ransomware or in large scale compromise, facilitating identification, containment and remediation phases.\n▪  Launch EDR Search and AV scan with IOC explicit rules and get first indicators for remediation progress following.\n▪  Set your EDR policies in prevent mode.\n\n---\n**Since this threat is often detected by end-users, raise your IT support awareness regarding the ransomware threat.**\n\n---\n**Block IOCs linked to ransomware activities gathered by Threat Intelligence.**\n\n---\n**Deploy and operate security solutions enabling detection and facilitating response:**\n▪  Log gathering in a SIEM\n▪  Have the capacity to run tools like YARA or DFIR-ORC (ANSSI)\n\n**Have a good log retention and verbosity\nDefine a strict posture versus the attacker\nPrepare internal and external communication strategy\nIf a machine is identified with ransomware, unplug it from network and keep it turned on for memory forensics investigation**\n\n---\n\n\n## BACKUPS PREPARATION:\n\nMake sure to have exhaustive, recent and reliable backups of local and network users’ data.\n\nYou can follow the 3-2-1 backup rules: each of these rules is meant to make sure that your data is stored in multiple ways.\n\nSo, if you’re backing something up, you would have:\n• At least **three copies**: three different copies mean three different copies in different places. By keeping them on different places, it reduces risk of a single event destroying multiple copies.\n• In **two different formats**: this means that you must use at least two different methods to store your data. For example, DVD, Hard drive, Cloud services are different formats. But if you store two copies into two hard drive, here you will just use one format.\n• With **one of those copies offsite**: Keeping one copy off-site ensures that even whatever happen where your data is (fire, break-in, natural disaster...) at least one copy is safe somewhere else. In this rule, cloud services make sense.\n\nTry to use one backup format stored out of your network: even lateral movement happens from the threat that harm your network with encryption one copy will be out of reach.","status":"Waiting","flag":false,"order":0,"extraData":{}},{"_id":"~3809447960","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504759,"title":"Identification","group":"default","description":"## OBJECTIVE: DETECT THE INCIDENT, DETERMINE ITS SCOPE, AND INVOLVE THE APPROPRIATE PARTIES.\n\n\n### GENERAL SIGNS OF RANSOMWARE PRESENCE\n\n**Several leads might hint that the system could be compromised by ransomware:**\n▪ Monitoring of ransomware IOCs by a SOC.\n▪ Supervision of EDR alerts.\n▪ Odd professional emails (often masquerading as invoices) containing attachments are being received.\n▪ A ransom message explaining that the documents have been encrypted and asking for money is displayed on user’s desktop.\n▪ People are complaining about their files not being available or corrupted on their computers or their network shares with unusual extensions (.abc, .xyz, .aaa, etc.).\n▪ Numerous files are being modified in a very short period of time on the network shares.\n▪ Publication of information on the ransomware operator websites or forums.\n▪ Lateral movement is usually done, check all connection to the AD and ShareFile server with privileged accounts at abnormal day time.\n▪ Look for unusual network or web browsing activities; especially connections to Tor I2P IP, Tor gateways (tor2web, etc.) or Bitcoin payment websites.\n▪ Look for rare connections.\n\n---\n**Scoping of the incident:**\n▪ EDR or large-scale hunting tools like YARA or DFIR-ORC allows to make the scoping of the ransomware infected machines.\n▪ The identification of the initial access and the pivot used by the attackers is the priority, as in Large scale malware compromise. This allows to establish the following phases actions.\n\n> **The identification of the Threat Actor at the origin of the ransomware attack could help the following phases based on known TTPs.**\n> Ransomware network compromise identification have many similarities with Large scale malware compromise. Most of the time, reaction decision must be taken faster in ransomware cases. For more details about Large scale malware compromise, please refer to IRM-18.","status":"Waiting","flag":false,"order":1,"extraData":{}},{"_id":"~3809452056","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670519504761,"title":"Remediation","group":"default","description":"## OBJECTIVE: TAKE ACTIONS TO REMOVE THE THREAT AND AVOID FUTURE INCIDENTS.\n\n▪ Remove the initial access used by the attacker.\n▪ Remove binaries used by the attacker to lateralize on the network.\n▪ Remove any accounts created by attackers.\n▪ Go back configuration changes.\n▪ Operate a systems and network configuration hardening.","status":"Waiting","flag":false,"order":3,"extraData":{}}]}