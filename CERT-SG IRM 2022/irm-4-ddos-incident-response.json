{"_id":"~3404292216","_type":"CaseTemplate","_createdBy":"florian@strangebee.com","_updatedBy":"florian@strangebee.com","_createdAt":1670261036501,"_updatedAt":1670261920975,"name":"IRM-4-DDoS-Incident-Response","displayName":"DDoS Incident Response (CERT-SG IRM4)","titlePrefix":"","description":"This Incident Response Methodology is a cheat sheet dedicated to handlers investigating on a precise security issue.\n\n**WHO SHOULD USE IRM SHEETS?**\n\n- Administrators\n- Security Operation Center\n- CISOs and deputies\n- CERTs (Computer Emergency Response Team)\n\n**Remember: If you face an incident, follow IRM, take notes. Keep calm and contact your business line’s Incident Response team or CERT immediately if needed.**\n\nReferences:\n→ IRM CERT SG: https://github.com/certsocietegenerale/IRM","severity":1,"tags":[],"flag":false,"tlp":2,"pap":2,"tasks":[{"_id":"~2999578664","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920968,"title":"Preparation","group":"default","description":"## OBJECTIVE: ESTABLISH CONTACTS, DEFINE PROCEDURES, GATHER INFORMATION TO SAVE TIME DURING AN INCIDENT.\n\n---\n**Internet Service Provider support**\n▪ Contact your ISP to understand the DDoS mitigation services it offers (free and paid) and what process you should follow.\n▪ If possible, subscribe to a redundant Internet connection and to an Anti-DDoS services provider.\n▪ Establish contacts with your ISP and law enforcement entities. Make sure that you have the possibility to use an out-of-band communication channel (e.g.: phone).\n▪ Make sure your ISP and DDoS mitigation service have a 24/7 phone support.\n\n---\n**Inventory**\n▪ Create a whitelist of the IP addresses and protocols you must allow if prioritizing traffic during an attack. Don’t forget to include your critical customers, key partners, etc.\n▪ Document your IT infrastructure details, including business owners, IP addresses and circuit IDs, routing settings (AS, etc); prepare a network topology diagram and an asset inventory. Network infrastructure\n▪ Design a good network infrastructure without Single Point of Failure or bottleneck.\n▪ Deploy a Web Application Firewall to protect against application-layer DDoS.\n▪ Distribute your DNS servers and other critical services (SMTP, etc) through different AS.\n▪ Harden the configuration of network, OS, and application components that may be targeted by DDoS.\n▪ Baseline your current infrastructure’s performance, so you can identify the attack faster and more accurately.\n▪ If your business is Internet dependent, consider purchasing specialized DDoS mitigation products or services.\n▪ Confirm DNS time-to-live (TTL) settings for the systems that might be attacked. Lower the TTLs, if necessary, to facilitate DNS redirection if the original IP addresses get attacked. 600 is a good TTL value.\n▪ Depending of the criticality of your services, consider setting-up a backup that you can switch on in case of issue.\n\n---\n**Internal contacts**\n▪ Establish contacts for your IDS, firewall, systems, and network teams.\n▪ Collaborate with the business lines to understand business implications (e.g., money loss) of likely DDoS attack scenarios.\n▪ Involve your BCP/DR planning team on DDoS incidents.","status":"Waiting","flag":false,"order":0,"extraData":{}},{"_id":"~3076415632","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920970,"title":"Identification","group":"default","description":"## OBJECTIVE: DETECT THE INCIDENT, DETERMINE ITS SCOPE, AND INVOLVE THE APPROPRIATE PARTIES.\n\n\n**Communication**\n▪ Prepare an internal and an external communication template about DDoS incidents.\n▪ Identify channel where this communication will be posted.\n▪ The “preparation” phase is to be considered as the most important element of a successful DDoS incident response.\n\n---\n**Analyze the attack**\n▪ Keep in mind the DDoS attack could be a smokescreen hiding a more sophisticated and targeted attack.\n▪ Check your anti-DDoS service analysis and your scrubbing centre reports:\n  o Understand the logical flow of the DDoS attack and identify the infrastructure components affected by it.\n  o Understand if you are the target of the attack or a collateral victim.\n▪ Review the load and log files of servers, routers, firewalls, applications, and other affected infrastructure.\n▪ Identify what aspects of the DDoS traffic differentiate it from benign traffic:\n  o Source IP addresses, AS, etc\n  o Destination ports\n  o URLs\n  o Protocols flags\n\nNetwork analysis tools can be used to review the traffic:\n**➔Tcpdump, Tshark, Snort, Netflow, Ntop, MRTG, Cacti, Nagios**\n\nIf possible, create a NIDS signature to focus to differentiate between benign and malicious traffic.\n\n---\n**Involve internal and external actors**\n▪ Contact your internal teams to learn about their visibility into the attack.\n▪ Contact your ISP to ask for help. Be specific about the traffic you’d like to control:\n  o Network blocks involved\n  o Source IP addresses\n  o Protocols\n▪ Notify your company’s executive and legal teams.\n\n---\n**Check the background**\n▪ Find out whether the company received an extortion demand as a precursor to the attack:\n  o Check for emails in your security email gateway based on a keyword list.\n  o Some threat actors send extortion demands directly to the email addresses in the Whois records of the targeted website.\n▪ Look for revendications of the attack on Social Medias.\n▪ Search if anyone would have any interest into threatening your company:\n  o Competitors\n  o Ideologically-motivated groups (hacktivists)\n  o Former employees","status":"Waiting","flag":false,"order":1,"extraData":{}},{"_id":"~3163168928","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920973,"title":"Recovery","group":"default","description":"## OBJECTIVE: RESTORE THE SYSTEM TO NORMAL OPERATIONS.\n\n**Assess the end of the DDoS condition**\n▪ Ensure that the impacted services are reachable again.\n▪ Ensure that your infrastructure performance is back to your baseline performance.\n\n---\n**Rollback the mitigation measures**\n▪ Switch back traffic to your original network.\n▪ Restart stopped services.\n\n> Ensure that the recovery-related actions are decided in accordance with the network teams. Bringing up services could have unexpected side effects.","status":"Waiting","flag":false,"order":4,"extraData":{}},{"_id":"~4059758672","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920971,"title":"Containment","group":"default","description":"## OBJECTIVE: MITIGATE THE ATTACK’S EFFECTS ON THE TARGETED ENVIRONMENT.\n\n▪ If the bottleneck is a particular feature of an application, temporarily disable that feature.\n▪ Attempt to throttle or block DDoS traffic as close to the network’s “cloud” as possible via a router, firewall, load balancer, specialized device, etc.\n▪ Terminate unwanted connections or processes on servers and routers and tune their TCP/IP settings.\n▪ If possible, switch to alternate sites or networks using DNS or another mechanism. Blackhole DDoS traffic targeting the original IP addresses.\n▪ Set up an alternate communication channel between you and your users/customers (e.g.: web server, mail server, voice server, etc.).\n▪ If possible, route traffic through a traffic-scrubbing service or product via DNS or routing changes (e.g.: sinkhole routing).\n▪ Configure egress filters to block the traffic your systems may send in response to DDoS traffic (e.g.: backsquatter traffic), to avoid adding unnecessary packets to the network.\n▪ In case of an extortion attempt, try to buy time with the fraudster. For example, explain that you need more time in order to get management approval.\n\n> If the bottleneck is at the ISP’s or anti-DDoS service’s side, only they can take efficient actions. In that case, work closely with your ISP and/or anti-DDoS provider and make sure you share information efficiently.","status":"Waiting","flag":false,"order":2,"extraData":{}},{"_id":"~4305522840","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920972,"title":"Remediation","group":"default","description":"## OBJECTIVE: TAKE ACTIONS TO STOP THE DENIAL-OFSERVICE CONDITION.\n\n> **IF THE ATTACK HAD A MAJOR IMPACT, YOU MAY HAVE TO MAKE AN INCIDENT REPORTING TO REGULATORS.\n> IF THE DDOS SPONSORS HAVE BEEN IDENTIFIED, CONSIDER INVOLVING LAW ENFORCEMENT\n> THIS SHOULD BE PERFORMED UPON THE DIRECTION OF YOUR COMPANY’S EXECUTIVE AND LEGAL TEAMS.**\n\n▪ Contact your ISP and/or anti-DDoS provider and make sure that they enforce remediation measures. For information, here are some of the possible measures:\n  o Filtering (if possible at level Tier1 or 2)\n  o Traffic-scrubbing/Sinkhole/Clean-pipe\n  o IP public balancing/splitting/switching\n  o Blackhole Routing\n\n**Technical remediation actions can mostly be enforced by your ISP and/or anti-DDoS provider.**","status":"Waiting","flag":false,"order":3,"extraData":{}},{"_id":"~4305526936","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1670261920974,"title":"Lessons learned","group":"default","description":"## OBJECTIVE: DOCUMENT THE INCIDENT’S DETAILS, DISCUSS LESSONS LEARNED, AND ADJUST PLANS AND DEFENSES.\n\n**Report**\nAn incident report should be written and made available to all applicable actors.\n\n\nThe following topics should be covered:\n▪ Initial detection\n▪ Actions and timelines of every important events\n▪ What went right\n▪ What went wrong\n▪ Impact from the incident\n▪ Indicators of compromise\n\n---\n**Lessons learned**\nActions to improve the DDoS management processes should be defined to capitalize on this experience.\nConsider what relationships inside and outside your organizations could help you with future incidents.","status":"Waiting","flag":false,"order":5,"extraData":{}}]}