{"_id":"~3072565352","_type":"CaseTemplate","_createdBy":"florian@strangebee.com","_updatedBy":"florian@strangebee.com","_createdAt":1651855093904,"_updatedAt":1652106151309,"name":"Windows Intrusion","displayName":"Windows Intrusion (CERT-SG IRM2)","titlePrefix":"","description":"Windows intrusion","severity":3,"tags":[],"flag":false,"tlp":2,"pap":2,"customFields":[],"tasks":[{"_id":"~1925730536","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373584,"title":"Unusual files","group":"Identification","description":"- Look for unusually big files on the storage support, bigger than 5MB. (can be an indication of a system compromised for illegal content storage)\n- Look for unusual files added recently in system folders, especially C:\\WINDOWS\\system32.\n- Look for files using the “hidden” attribute: C:\\> dir /S /A:H\n- Use “windirstat” if possible.","status":"Waiting","flag":false,"order":5,"extraData":{}},{"_id":"~1925734632","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373600,"title":"Unusual log entries","group":"Identification","description":"Watch your log files for unusual entries:\n\nC:\\> eventvwr.msc\n\nIf possible, use “Event Log Viewer” or such tool\n\nSearch for events affecting the firewall, the antivirus, the file protection, or any suspicious new service.\n\nLook for a huge amount of failed login attempts or locked out accounts.\n\nWatch your firewall (if any) log files for suspect activity.","status":"Waiting","flag":false,"order":12,"extraData":{}},{"_id":"~2213048568","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373580,"title":"Provide access to forensic investigator","group":"Preparation","description":"A physical access to the suspicious system should be given to the forensic investigator. Physical access is preferred to remote access, since the hacker could detect the investigations done on the system (by using a network sniffer for example).","status":"Waiting","flag":false,"order":0,"extraData":{}},{"_id":"~2213052664","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373582,"title":"Know your network","group":"Preparation","description":"A good knowledge of the usual network activity of the machine/server is needed. \n\nYou should have a file on a secure place describing the usual port activity, to compare efficiently to the current state.","status":"Waiting","flag":false,"order":2,"extraData":{}},{"_id":"~2213056760","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373583,"title":"Know your network","group":"Preparation","description":"A good knowledge of the usual services running on the machine can be very helpful. \n\nDon’t hesitate to ask a Windows Expert for his assistance, when applicable. \n\nA good idea is also to have a map of all services/running process of the machine.","status":"Waiting","flag":false,"order":3,"extraData":{}},{"_id":"~2213060856","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373585,"title":"Unusual Registry Entries","group":"Identification","description":"Look for unusual programs launched at boot time in the Windows registry, especially:\n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce\n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx \n- Use “HiJackThis” if possible. (Also have a look in your Startup folder)","status":"Waiting","flag":false,"order":6,"extraData":{}},{"_id":"~2213064952","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373599,"title":"Unusual Network Activity","group":"Identification","description":"- Check for file shares and verify each one is linked to a normal activity:\n\nC:\\> net view \\\\127.0.0.1\n\nUse “tcpview” if possible.\n\n- Look at the opened sessions on the machine:\nC:\\> net session\n- Have a look at the sessions the machine has opened with other systems:\nC:\\> net use\n- Check for any suspicious Netbios connexion:\nC:\\> nbtstat –S\n- Look for any suspicious activity on the system’s ports :\nC:\\> netstat –na 5\n(5 makes it being refreshed each 5 seconds)\nUse –o flag for Windows XP/2003 to see the owner of each process:\nC:\\> netstat –nao 5\nUse “fport” if possible.","status":"Waiting","flag":false,"order":10,"extraData":{}},{"_id":"~2213069048","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373599,"title":"Unusual Automated Tasks","group":"Identification","description":"Look at the list of scheduled tasks for any unusual entry: \n\nC:\\> at\n\nOn Windows 2003/XP: C:\\> schtasks","status":"Waiting","flag":false,"order":11,"extraData":{}},{"_id":"~2213073144","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373602,"title":"Malware check","group":"Identification","description":"Run at least one anti-virus product on the whole disk. If possible use several anti-virus. The anti-virus must absolutely be up-to- date.","status":"Waiting","flag":false,"order":14,"extraData":{}},{"_id":"~2213077240","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373603,"title":"Check all files accessed recently","group":"Containment","description":"","status":"Waiting","flag":false,"order":16,"extraData":{}},{"_id":"~2213081336","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373606,"title":"Remove access to the accounts involved","group":"Remediation","description":"Temporary remove all accesses to the accounts involved in the incident.","status":"Waiting","flag":false,"order":20,"extraData":{}},{"_id":"~2213085432","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373607,"title":"Change system accounts passwords","group":"Recovery","description":"No matter how far the hacker has gone into the system and the knowledge you might have about the compromission, as long as the system has been penetrated, the best practice is to reinstall the system fully from original media and apply all fixes to the newly installed system.\nIn case this solution can’t be applied, you should:\n\nChange all the system’s accounts passwords, and make your users do so in a secure way: \nthey should use passwords with upper/lower case, special characters, numbers, and at least be 8 characters long.","status":"Waiting","flag":false,"order":22,"extraData":{}},{"_id":"~2377011440","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373583,"title":"Unusual accounts","group":"Identification","description":"Look for unusual accounts created, especially in the Administrators group:\n\nC:\\> lusrmgr.msc\n\nor\n\nC:\\> net localgroup administrators or net localgroup administrateurs","status":"Waiting","flag":false,"order":4,"extraData":{}},{"_id":"~2377015536","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373597,"title":"Check user's autostart folders","group":"Identification","description":"C:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup \n\nC:\\WinNT\\Profiles\\user\\Start Menu\\Programs\\Startup","status":"Waiting","flag":false,"order":8,"extraData":{}},{"_id":"~2377019632","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373598,"title":"Look for unusual/unexpected network services installed and started","group":"Identification","description":"C:\\> services.msc\n\nC:\\> net start","status":"Waiting","flag":false,"order":9,"extraData":{}},{"_id":"~2377023728","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373601,"title":"Rootkit check","group":"Identification","description":"Run “Rootkit Revealer”, “Rootkit Hooker”, “Ice Sword”, “Rk Detector”, “SysInspector”, “Rootkit Buster”.\n\nIt’s always better to run several of these tools than only one.","status":"Waiting","flag":false,"order":13,"extraData":{}},{"_id":"~2377027824","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373604,"title":"Inspect network","group":"Containment","description":"Inspect network shares to see if the malware has spread\nthrough it.","status":"Waiting","flag":false,"order":17,"extraData":{}},{"_id":"~2377031920","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373604,"title":"Find initial access","group":"Containment","description":"try to find how the attacker got into the system. All leads should be considered. If no computer proof of the intrusion is found, never forget it could come from a physical access or a complicity/stealing of information from an employee.","status":"Waiting","flag":false,"order":18,"extraData":{}},{"_id":"~2377036016","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373607,"title":"Remove malicious files","group":"Remediation","description":"Remove all malicious files installed by the attacker.","status":"Waiting","flag":false,"order":21,"extraData":{}},{"_id":"~2377040112","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373610,"title":"Capitalize","group":"Aftermath","description":"Actions to improve the Windows intrusion detection management processes should be defined to capitalize on this experience","status":"Waiting","flag":false,"order":25,"extraData":{}},{"_id":"~2745507848","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373608,"title":"Restore all changed files","group":"Recovery","description":"No matter how far the hacker has gone into the system and the knowledge you might have about the compromission, as long as the system has been penetrated, the best practice is to reinstall the system fully from original media and apply all fixes to the newly installed system.\nIn case this solution can’t be applied, you should:\n\nRestore all files that could have been changed (Example: svchost.exe) by the attacker.","status":"Waiting","flag":false,"order":23,"extraData":{}},{"_id":"~2745511944","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373609,"title":"Report","group":"Aftermath","description":"A crisis report should be written and made available to all of the actors of the crisis management cell.\nThe following themes should be described: \n- Initial detection\n- Actions and timelines of every important event \n- What went right\n- What went wrong\n- Incident cost","status":"Waiting","flag":false,"order":24,"extraData":{}},{"_id":"~2949722328","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373605,"title":"Apply fixes","group":"Containment","description":"Apply fixes when applicable (operating system and applications), in case the attacker used a known vulnerability.","status":"Waiting","flag":false,"order":19,"extraData":{}},{"_id":"~2990788656","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373581,"title":"Make disk copy","group":"Preparation","description":"A physical copy of the hard-disk might be necessary for forensic and evidence purposes. \n\nFinally, if needed, a physical access could be needed to disconnect the suspected machine from any network.","status":"Waiting","flag":false,"order":1,"extraData":{}},{"_id":"~2990792752","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373597,"title":"Unusual processes and services","group":"Identification","description":"Check all running processes for unusual/unknown entries, especially processes with username “SYSTEM” and “ADMINISTRATOR”:\n\nC:\\> taskmgr.exe\n\n(or tlisk, tasklist depending on Windows release)\n\nUse “psexplorer” if possible.","status":"Waiting","flag":false,"order":7,"extraData":{}},{"_id":"~2990796848","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1651865373602,"title":"Find all files used by the attacker","group":"Containment","description":"including deleted files (use your forensic tools) and see what has been done with it or at least their functionality, in order to evaluate the threat.\n\nIf the machine is considered critical for your company’s business activity and can’t be disconnected, backup all important data in case the hacker notices you’re investigating and starts deleting files. Also make a copy of the system’s memory for further analysis. (use tools such as Memoryze,win32dd etc.)\n\nMake a physical copy (bit by bit) of the whole hard disk on an external storage support, using EnCase, X-Ways, or similar forensic tool (dd, ddrescue etc.).","status":"Waiting","flag":false,"order":15,"extraData":{}}]}