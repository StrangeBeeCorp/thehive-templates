{"_id":"~245854232","_type":"CaseTemplate","_createdBy":"thehive@thehive.local","_updatedBy":"thehive@thehive.local","_createdAt":1757938468861,"_updatedAt":1757949081972,"name":"Network Denial of Service  - Containment","displayName":"","description":"# 🌐 Network Denial of Service – Containment\n\n---\n\n## 🎯 Usage\n\nImmediately implement actions to:\n\n* Mitigate the impact of a network denial-of-service attack\n* Maintain availability of critical services\n* Collaborate with operators and service providers\n* Prepare hardening measures\n\n---\n\n## ⚙️ Prerequisites before starting\n\n* ✅ Incident qualified: confirmed as a malicious denial of service (not a production incident), with severity and characteristics established\n  → Recommended sheet: *Network Denial of Service – Qualification*\n* 🔑 Administration capabilities available (network, system, security) and external actors mobilizable\n\n---\n\n## 📌 Objectives\n\n### ✅ Select appropriate actions\n\n1. Sequence actions within the defined scope and select measures based on the attack’s characteristics\n\n### ✅ Limit impacts\n\n2. Limit traffic upstream of the entity (via the ISP)\n3. Act within the hosting provider’s scope\n4. Act within the scope of dependent services\n\n### ✅ Preserve traces\n\n5. Retain logs and evidence\n\n---\n\n## 📄 Resource\n\n👉 [Full reflex sheet – INTERCERT-FR](https://www.intercert-france.fr/wp-content/uploads/2025/06/fichereflexe-denideservice-endiguement.pdf)","severity":1,"severityLabel":"LOW","tags":["ddos","denial-of-service","containment","network"],"flag":false,"tlp":2,"tlpLabel":"AMBER","pap":2,"papLabel":"AMBER","customFields":[],"tasks":[{"_id":"~82378808","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081934,"title":"Measure 1 – Sequence your actions and determine measures based on the denial of service","group":"Containment","description":"### 🎯 Objective\n\nDetermine the priority actions to implement based on the type of denial of service.\n\n### 📌 Actions\n\n* Define the scope and sequence of containment actions\n\n  * Start with the upstream elements of the failing component to reduce traffic targeting it\n  * End with the failing components themselves to reduce overload\n  * Apply containment actions one by one to assess effectiveness and measure potential side effects\n* Select containment actions according to the denial-of-service type (see reflex sheet)\n  → [Volumetric denial of service]\n  → [Protocol-based denial of service]\n  → [Application-level denial of service]\n  → [DNS service denial of service]\n\n### ✅ Deliverables\n\n* Ordered list of containment actions documented in the **activities** of this task","status":"Waiting","flag":false,"order":0,"mandatory":false,"extraData":{}},{"_id":"~82382904","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081968,"title":"Closure & Lessons Learned (Post-Incident Review)","group":"Containment","description":"### 🎯 Objective\n\nConsolidate what worked and plan **hardening**.\n\n### 📌 Actions\n\n* Review thresholds, *peacetime tuning*\n* Adjust contracts/procedures\n\n### ✅ Deliverables\n\nPost-incident review + hardening backlog","status":"Waiting","flag":false,"order":5,"mandatory":false,"extraData":{}},{"_id":"~123072624","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081962,"title":"Measure 5 – Preserve traces","group":"Containment","description":"### 🎯 Objective\n\nPreserve the oldest possible logs.\n\n### 📌 Actions\n\n* Preserve traces from equipment logs\n* Export logs from mapped elements or manual network captures\n\n### ✅ Deliverables\n\n* Logs exported and added to the incident","status":"Waiting","flag":false,"order":4,"mandatory":false,"extraData":{}},{"_id":"~123179160","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081944,"title":"Measure 2 – Limit traffic upstream of the entity (with the ISP)","group":"Containment","description":"### 🎯 Objective\n\nFilter traffic within the Internet Service Provider (ISP) scope and limit requests reaching the entity’s infrastructure. This type of containment is especially relevant when a strong discriminant (e.g., source IP, protocol) has been identified during the qualification phase.\n\n### 📌 Actions\n\n* Identify a technical contact at your ISP\n* Limit traffic upstream of the entity (with the ISP)\n* Activate the ISP’s anti-DDoS service\n\n### ✅ Deliverables\n\n* Limitation implemented by the ISP\n* Evidence of ISP limitation added to the **activities** of this task","status":"Waiting","flag":false,"order":1,"mandatory":false,"extraData":{}},{"_id":"~204943528","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081950,"title":"Measure 3 – Act within the hosting provider’s scope","group":"Containment","description":"### 🎯 Objective\n\n**Adapt** rules to attack variations within the hosting provider’s scope.\n\n### 📌 Actions\n\n* Activate the hosting provider’s anti-DDoS service (upstream of firewall and router)\n\n  * Enable the service if available\n  * Update blocking rules and rate-control thresholds based on discriminants identified during qualification\n  * If available, enable the following:\n\n    * Block requests to invalid destinations (non-exposed ports)\n    * Block malicious source IPs via CTI\n    * Bot detection (dynamic captcha or JavaScript challenge)\n    * Blocking by JA3/S and JA4 fingerprints\n    * Other relevant anti-DDoS features\n\n* Limit requests on network infrastructure equipment\n\n  * Administration network\n\n    * Implement QoS to prioritize admin traffic during unavailability\n  * Firewall\n\n    * Update firmware if a DoS exploits a vulnerability\n    * Harden rules to limit exposed services and protocols. Reject the rest\n    * Enable malformed packet blocking or DoS protection if possible\n    * Block based on discriminants from qualification (source IP, protocol, geolocation)\n    * Block known malicious source IPs (CTI)\n    * Filter by authorized IPs/blocks/AS/geolocation\n    * If non-essential services are targeted, apply temporary blackholing on the target IPs while restoring indirectly affected services according to importance\n    * \\[Volumetric DoS]\n\n      * Apply rate limiting. Define thresholds per source IP (bandwidth, packets/s, requests with malicious signatures)\n      * Monitor to detect side effects\n      * Apply traffic shaping to prioritize certain flows\n    * \\[Protocol-based DoS]\n\n      * Reduce connection tracking lifetimes\n      * Limit SYN packets/s per source and destination IP\n      * Enable SYN cookies\n      * Set ICMP/s and UDP/s thresholds per source IP\n  * Web Application Firewall (WAF)\n\n    * Update attack signatures\n    * Simplify configuration to reduce CPU load\n    * \\[Volumetric DoS]: apply rate limiting or traffic shaping\n    * \\[Application DoS]\n\n      * Block malicious requests by signature\n      * Apply precise rules on observed L7 discriminants. Avoid applying during major volumetric attacks to prevent CPU overload\n    * Limit web sessions\n    * Enable caching\n    * Bot detection (dynamic captcha or JavaScript challenge)\n    * Reduce connection tracking lifetimes\n  * Load balancer\n\n    * Apply rate limiting\n    * Reduce connection tracking lifetimes\n\n* Limit requests on resources\n\n  * Hypervisor\n\n    * Optimize resources in case of saturation\n\n      * Distribute load (create instances)\n      * Allocate or reallocate resources\n      * Separate instances by geographic zones (sharding)\n      * Update the hypervisor\n      * Migrate other machines to free resources\n      * Migrate the impacted machine to relaunch other services\n  * Front-end or application servers\n\n    * System saturated\n\n      * If inaccessible: cut production network access, reboot, apply optimizations, reopen traffic\n      * Allocate more resources\n      * Adjust limiting system thresholds (ulimit, systemd)\n      * Low-level optimization (Linux sysctl, Windows System Resource Manager)\n    * \\[Application DoS]\n\n      * Temporarily disable problematic non-essential features (search engine, forms)\n      * Limit web sessions\n      * Enable caching\n      * Bot detection (dynamic captcha or JavaScript challenge)\n      * Reduce connection tracking lifetimes\n      * Optimize web and component configuration (Apache, Nginx, IIS; .NET, JRE; Tomcat, JBoss, Node.js)\n      * Serve static content separately and dedicate servers\n      * Restart services if blocked processes are found, after assessing impact\n  * Database servers\n\n    * \\[Application DoS]\n\n      * Optimize resources and configuration in case of saturation\n      * Add instances if clustering allows\n\n### ✅ Deliverables\n\n* All actions performed documented in the **activities** of this task","status":"Waiting","flag":false,"order":2,"mandatory":false,"extraData":{}},{"_id":"~205070584","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757949081957,"title":"Measure 4 – Act within the scope of dependent services","group":"Containment","description":"### 🎯 Objective\n\nEnsure DNS resolution and vital services.\n\n### 📌 Actions\n\n* Adjust DNS service configurations\n\n  * Filter malformed or invalid DNS requests\n  * Filter requests for non-existent DNS records\n* Enable CDN for attacks targeting static content, if possible\n* Act on third-party components\n* Enable an external anti-DDoS service, if possible\n\n### ✅ Deliverables\n\n* Stability of key services\n* Actions documented in the **activities** of this task","status":"Waiting","flag":false,"order":3,"mandatory":false,"extraData":{}}],"extraData":{"pageTemplateHeaders":[]}}