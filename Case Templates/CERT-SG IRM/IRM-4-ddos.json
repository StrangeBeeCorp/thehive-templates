{"_id":"~3317813424","_type":"CaseTemplate","_createdBy":"florian@strangebee.com","_updatedBy":"florian@strangebee.com","_createdAt":1652087497267,"_updatedAt":1652176736590,"name":"DDOS","displayName":"DDOS (CERT-SG IRM4)","titlePrefix":"","description":"DDOS","severity":2,"tags":["veris:action:hacking:variety=\"DoS\""],"flag":false,"tlp":2,"pap":2,"customFields":[],"tasks":[{"_id":"~1966166248","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100077,"title":"Internal contacts","group":"Preparation","description":"- Establish contacts for your IDS, firewall, systems, and network teams.\n- Collaborate with the business lines to understand business implications (e.g., money loss) of likely DDoS attack scenarios.\n- Involve your BCP/DR planning team on DDoS incidents.\n\nThe “preparation” phase is to be considered as the most important element of a successful DDoS incident response.","status":"Waiting","flag":false,"order":3,"extraData":{}},{"_id":"~2457768080","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100075,"title":"Inventory","group":"Preparation","description":"- Create a whitelist of the IP addresses and protocols you must allow if prioritizing traffic during an attack. Don’t forget to include your critical customers, key partners, etc.\n- Document your IT infrastructure details, including business owners, IP addresses and circuit IDs, routing settings (AS, etc); prepare a network topology diagram and an asset inventory.","status":"Waiting","flag":false,"order":1,"extraData":{}},{"_id":"~2457772176","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100076,"title":"Network Infrastructure","group":"Preparation","description":"- Design a good network infrastructure without Single Point of Failure or bottleneck.\n- Distribute your DNS servers and other critical services (SMTP, etc) through different AS.\n- Harden the configuration of network, OS, and application components that may be targeted by DDoS.\n- Baseline your current infrastructure’s performance, so you can identify the attack faster and more accurately.\n- If your business is Internet dependent, consider purchasing specialized DDoS mitigation products or services.\n- Confirm DNS time-to-live (TTL) settings for the systems that might be attacked. Lower the TTLs, if necessary, to facilitate DNS redirection if the original IP addresses get attacked. 600 is a good TTL value.\n- Depending of the criticality of your services, consider setting- up a backup that you can switch on in case of issue.","status":"Waiting","flag":false,"order":2,"extraData":{}},{"_id":"~2457776272","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100100,"title":"Lessons learned","group":"Aftermath","description":"- Consider what preparation steps you could have taken to respond to the incident faster or more effectively.\n- If necessary, adjust assumptions that affected the decisions made during DDoS incident preparation.\n- Assess the effectiveness of your DDoS response process, involving people and communications.\n- Consider what relationships inside and outside your organizations could help you with future incidents.\n- Collaborate with legal teams if a legal action is in process.","status":"Waiting","flag":false,"order":11,"extraData":{}},{"_id":"~2539618304","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100074,"title":"Internet Service Provider support","group":"Preparation","description":"- Contact your ISP to understand the DDoS mitigation services it offers (free and paid) and what process you should follow.\n- If possible, subscribe to a redundant Internet connection.\n- If possible, subscribe to an Anti-DDoS service provider.\n- Establish contacts with your ISP and law enforcement entities. Make sure that you have the possibility to use an out-of-band communication channel (e.g.: phone).","status":"Waiting","flag":false,"order":0,"extraData":{}},{"_id":"~2539622400","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100079,"title":"Involve internal and external actors","group":"Identification","description":"- Contact your internal teams to learn about their visibility into the attack.\n- Contact your ISP to ask for help. Be specific about the traffic you’d like to control:\n  - Network blocks involved\n  - Source IP addresses\n  - Protocols\n- Notify your company’s executive and legal teams.","status":"Waiting","flag":false,"order":5,"extraData":{}},{"_id":"~2539626496","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100080,"title":"Check the background","group":"Identification","description":"- Find out whether the company received an extortion demand as a precursor to the attack.\n- Search if anyone would have any interest into threatening your company\n  - Competitors\n  - Ideologically-motivated groups (hacktivists)\n  - Former employees","status":"Waiting","flag":false,"order":6,"extraData":{}},{"_id":"~2539630592","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100093,"title":"Stop the Denial of Service condition","group":"Remediation","description":"- Contact your ISP and make sure that it enforces remediation measures. For information, here are some of the possible measures:\n  - Filtering (if possible at level Tier1 or 2) \n  - Traffic-scrubbing/Sinkhole/Clean-pipe \n  - Blackhole Routing\n- If the DDoS sponsors have been identified, consider involving law enforcement. This should be performed upon the direction of your company’s executive and legal teams.\n\n**Technical remediation actions can mostly be enforced by your ISP.**","status":"Waiting","flag":false,"order":8,"extraData":{}},{"_id":"~2539634688","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100097,"title":"Rollback the mitigation measures","group":"Recovery","description":"- Switch back traffic to your original network. \n- Restart stopped services.\n\n**Ensure that the recovery-related actions are decided in accordance with the network teams. Bringing up services could have unexpected side effects.**","status":"Waiting","flag":false,"order":10,"extraData":{}},{"_id":"~2990137560","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100078,"title":"Analyze the attack","group":"Identification","description":"- Understand the logical flow of the DDoS attack and identify the infrastructure components affected by it.\n- Understand if you are the target of the attack or a collateral victim\n- Review the load and log files of servers, routers, firewalls, applications, and other affected infrastructure\n- Identify what aspects of the DDoS traffic differentiate it from benign traffic\n  - Source IP addresses, AS, etc\n  - Destination ports\n  - URLs\n  - Protocols flags\nNetwork analysis tools can be used to review the traffic:\nTcpdump, Tshark, Snort, Argus, Ntop, Aguri, MRTG\n\n- If possible, create a NIDS signature to focus to differentiate between benign and malicious traffic.","status":"Waiting","flag":false,"order":4,"extraData":{}},{"_id":"~2990141656","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100092,"title":"Mitigate the attack’s effects","group":"Containment","description":"- If the bottleneck is a particular feature of an application, temporarily disable that feature.\n- Attempt to throttle or block DDoS traffic as close to the network’s “cloud” as possible via a router, firewall, load balancer, specialized device, etc.\n- Terminate unwanted connections or processes on servers and routers and tune their TCP/IP settings.\n- If possible, switch to alternate sites or networks using DNS or another mechanism. Blackhole DDoS traffic targeting the original IP addresses.\n- Set up an alternate communication channel between you and your users/customers (e.g.: web server, mail server, voice server, etc.)\n- If possible, route traffic through a traffic-scrubbing service or product via DNS or routing changes (e.g.: sinkhole routing)\n- Configure egress filters to block the traffic your systems may send in response to DDoS traffic (e.g.: backsquatter traffic), to avoid adding unnecessary packets to the network.\n- In case of an extortion attempt, try to buy time with the fraudster. For example, explain that you need more time in order to get management approval.\n\n\n**If the bottleneck is at the ISP’s side, only the ISP can take efficient actions. In that case, work closely with your ISP and make sure you share information efficiently.**","status":"Waiting","flag":false,"order":7,"extraData":{}},{"_id":"~3317833904","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652089100095,"title":"Assess the end of the DDoS condition","group":"Recovery","description":"- Ensure that the impacted services are reachable again.\n- Ensure that your infrastructure performance is back to your baseline performance.","status":"Waiting","flag":false,"order":9,"extraData":{}}]}