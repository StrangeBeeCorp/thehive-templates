{"_id":"~2457841808","_type":"CaseTemplate","_createdBy":"florian@strangebee.com","_updatedBy":"florian@strangebee.com","_createdAt":1652096474720,"_updatedAt":1652100213959,"name":"Windows Malware Detection","displayName":"Windows Malware Detection (CERT-SG IRM7)","titlePrefix":"","description":"Windows Malware Detection","severity":2,"tags":[],"flag":false,"tlp":2,"pap":2,"customFields":[],"tasks":[{"_id":"~1966227688","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213929,"title":"General signs of malware presence on the desktop","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nSeveral leads might hint that the system could be compromised by malware:\n- Antivirus software raising an alert, unable to update its signatures, shutting down or unable to run manual scans.\n- Unusual hard-disk activity: the hard drive makes huge operations at unexpected times.\n- Unusually slow computer: sudden, unexplained slowdowns not related to system usage.\n- Unusual network activity: Slow internet connection / poor network share performance at irregular intervals.\n- The computer reboots without reason.\n- Applications crashing unexpectedly.\n- Pop-up windows appearing while browsing the web. (sometimes even without browsing)\n- Your IP address (if static) is blacklisted on one or more Internet Black Lists.\n- People are complaining about you e-mailing them/reaching them by IM etc. while you did not.\n\nActions below uses default Windows tools. Authorized users can use the SysInternals Troubleshooting Utilities to perform these tasks.","status":"Waiting","flag":false,"order":1,"extraData":{}},{"_id":"~1966231784","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213931,"title":"Unusual Files","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Look for unusual big files on the storage support, bigger than 10MB seems to be reasonable.\n- Look for unusual files added recently in system folders, especially *%SystemRoot%\\system32.*\n- Look for files using the“hidden”attribute: \n\n```\nC:\\> dir /S /A:H\n```","status":"Waiting","flag":false,"order":3,"extraData":{}},{"_id":"~1966235880","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213955,"title":"Restore files","group":"Recovery","description":"If possible reinstall the OS and applications and restore user’s data from clean, trusted backups. If deemed necessary, you may ask your local IT helpdesk to reimage the disk.\n\nIn case the computer has not been reinstalled completely:\n**Restore files which could have been corrupted by the malware, especially system files.**","status":"Waiting","flag":false,"order":11,"extraData":{}},{"_id":"~2457886864","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213933,"title":"Unusual Network Activity","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n \n- Check for file shares : \n```\nC:\\> net view \\\\127.0.0.1 \n```\n\n- List opened sessions on the machine:\n\n```\nC:\\> net session\n```\n\n- Check for opened shares on other systems: \n```\nC:\\> net use\n```\n\n- Check for suspicious Netbios connexions: \n```\nC:\\> nbtstat –S\n```\n\n- Look for any suspicious network connections\n\n```\nC:\\> netstat –na 5\n```\n\n(the -a 5 flag sets the refresh interval to 5 seconds)\n\nAdd the -o flag for Windows XP/2003 to dislpay the owner of each process\n\n- Use a sniffer (Wireshark, tcpdump etc.) and see if there are unusual attempts of connections to or from remote systems. try browsing sensitive websites (banking website for example) and check if unusual network activity is triggered.\n\n Note: A good knowledge of the legitimate network activity is needed.","status":"Waiting","flag":false,"order":6,"extraData":{}},{"_id":"~2457890960","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213950,"title":"Unusual Automated Tasks","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Look at the list of scheduled tasks for any unusual entry: \n```\nC:\\> at\n```\n\nOn Windows 2003/XP : \n```\nC:\\> schtasks\n```\n\n- Also check user’s autostart directories:\n\n```\nC:\\Documents and Settings\\user\\Start Menu\\Programs\\Startup C:\\WinNT\\Profiles\\user\\Start Menu\\Programs\\Startup\n```","status":"Waiting","flag":false,"order":7,"extraData":{}},{"_id":"~2457895056","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213958,"title":"Capitalize","group":"Aftermath","description":"Actions to improve malware detection and eradication processes should be defined to capitalize on this experience.","status":"Waiting","flag":false,"order":14,"extraData":{}},{"_id":"~2539655168","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213927,"title":"Preparation","group":"Preparation","description":"- A physical access to the suspicious system should be offered to the forensic investigator.\n- A good knowledge of the usual network and local activities of the computer is appreciated. You should have a file describing the usual port activity, to have a comparison base with current state.\n- A good knowledge of the common used services and installed applications is needed. Don’t hesitate to ask a Windows Expert for their assistance, when applicable.","status":"Waiting","flag":false,"order":0,"extraData":{}},{"_id":"~2539659264","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213932,"title":"Unusual Registry Entries","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nLook for unusual programs launched at boot time in the Windows registry, especially: \n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce\n- HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx \n- HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion \\Winlogon\n\nCheck for the same entries in HKCU\n\nYou can use Microsoft Sysinternals Autoruns to view them all.","status":"Waiting","flag":false,"order":4,"extraData":{}},{"_id":"~2539663360","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213954,"title":"Remove the binaries and the related registry entries","group":"Remediation","description":"Reboot from a live CD and backup all important data on an external storage support. If unsure, bring your hard-drive to your IT helpdesk and ask them to make a copy of the important content.\n\n- Find the best practices to remove the malware. They can usually be found on AntiVirus companies’ websites.\n- Run an online antivirus scan.\n- Launch a Bart PE- based live CD containing disinfection tools (can be downloaded from AV websites), or a dedicated anti-virus live CD.","status":"Waiting","flag":false,"order":10,"extraData":{}},{"_id":"~2990174424","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213952,"title":"Containment","group":"Containment","description":"Pull the network plug off physically, to prevent more infection on the network and to stop any actions being done from your computer (e.g. the malware could be sending spam, taking part in a DDoS attack or storing illegal files on the system).\n\nSend the suspect binaries to your CERT, or request CERT’s help if you are unsure about the malware’s nature. The CERT should be able to isolate the malicious content and can send it to all AV companies, including your corporate contractors. (The best way is to create a zipped, password-encrypted file of the suspicious binary.)","status":"Waiting","flag":false,"order":9,"extraData":{}},{"_id":"~3194990760","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213956,"title":"Reboot the machine","group":"Recovery","description":"If possible reinstall the OS and applications and restore user’s data from clean, trusted backups. If deemed necessary, you may ask your local IT helpdesk to reimage the disk.\n\n**Reboot the machine** after all the suspicious files have been removed, and confirm that the workstation is not exhibiting any unusual behaviour. A full, up-to-date AV scan of the hard-drive and memory are recommended.","status":"Waiting","flag":false,"order":12,"extraData":{}},{"_id":"~3235995872","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213951,"title":"Unusual Log Entries","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Check log files for unusual entries: \n```\nC:\\> eventvwr.msc\n```\n\n- Search for events like the following:\n\n```\n“Event log service was stopped”\n“Windows File Protection is not active”\n“The protected System file <name> was not restored to its original”\n“Telnet Service has started successfully”\n```\n\n- Check firewall log files for suspect activity. You can also use an up-to-date antivirus to identify malware on the system, but be aware that it could destroy evidence.\n\n\nIf nothing suspicious has been found, it doesn’t necessarily mean that the system is not infected (a rootkit could have been installed). The system may be investigated further by making a bit-by-bit copy of the incriminated hard-drive and analysing the copy with tools such as X-Ways, FTK or Encase.","status":"Waiting","flag":false,"order":8,"extraData":{}},{"_id":"~3235999968","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213957,"title":"Report","group":"Aftermath","description":"An incident report should be written and made available to all of the stakeholders.\nThe following themes should be described: \n- Initial detection.\n- Actions and timelines.\n- What went right.\n- What went wrong. \n- Incident cost.","status":"Waiting","flag":false,"order":13,"extraData":{}},{"_id":"~3604607112","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213930,"title":"Unusual Accounts","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\nLook for unusual and unknown accounts created, especially in the Administrators group:\n\n```\nC:\\> lusrmgr.msc\n```","status":"Waiting","flag":false,"order":2,"extraData":{}},{"_id":"~3604611208","_type":"Task","_createdBy":"florian@strangebee.com","_createdAt":1652100213933,"title":"Unusual Processes and Services","group":"Identification","description":"**IMPORTANT**\n\nBefore carrying out any other actions, make sure to make a volatile memory capture by downloading and running FTK Imager or another utility from a USB key or disk\nVolatile data provides valuable forensic information and is straightforward to acquire.\n\n**IMPORTANT**\n\n- Check all running processes for unusual/unknown entries, especially processes with username “SYSTEM” and “ADMINISTRATOR” :\n\n```\nC:\\> taskmgr.exe\n```\n\n(or tlisk, tasklist depending on Windows release)\n- Look for unusual/unexpected network services installed and started:\n\n```\nC:\\> services.msc\nC:\\> net start\n```\n\n Note: a good knowledge of common Windows services is needed.","status":"Waiting","flag":false,"order":5,"extraData":{}}]}