{"_id":"~675888","_type":"CaseTemplate","_createdBy":"thehive@thehive.local","_updatedBy":"thehive@thehive.local","_createdAt":1755071155430,"_updatedAt":1757606627781,"name":"DÃ©ni de service rÃ©seau - Endiguement","displayName":"","description":"# ğŸŒ DÃ©ni de service rÃ©seau â€“ Endiguement\n\n---\n\n## ğŸ¯ Usage\nMettre en Å“uvre immÃ©diatement les actions pour :  \n- AttÃ©nuer lâ€™impact dâ€™une attaque par dÃ©ni de service rÃ©seau  \n- Maintenir lâ€™accessibilitÃ© des services critiques  \n- Collaborer avec opÃ©rateurs et prestataires  \n- PrÃ©parer les mesures de durcissement \n \n---\n\n## âš™ï¸ PrÃ©requis avant dÃ©marrage\n- âœ… Incident qualifiÃ© : confirmÃ© comme dÃ©ni de service malveillant (non incident de prod), gravitÃ© et caractÃ©ristiques Ã©tablies  \n  â†’ Fiche conseillÃ©e : *DÃ©ni de service rÃ©seau â€“ Qualification*  \n- ğŸ”‘ CapacitÃ©s dâ€™administration disponibles (rÃ©seau, systÃ¨me, sÃ©curitÃ©) et acteurs externes mobilisables  \n\n\n---\n\n## ğŸ“Œ Objectifs\n\n### âœ… SÃ©lectionner les actions appropriÃ©es\n1. Ordonner les actions dans le pÃ©rimÃ¨tre dÃ©fini et sÃ©lectionner les mesures en fonction des caractÃ©ristiques de lâ€™attaque  \n\n### âœ… Limiter les impacts\n2. Limiter le trafic en amont de lâ€™entitÃ© (via le FAI)  \n3. Agir dans le pÃ©rimÃ¨tre de lâ€™hÃ©bergeur  \n4. Agir dans le pÃ©rimÃ¨tre des services dÃ©pendants  \n\n### âœ… PrÃ©server les traces\n5. Conserver les journaux et preuves  \n\n---\n\n## ğŸ“„ Ressource\nğŸ‘‰ [Fiche rÃ©flexe complÃ¨te â€“ INTERCERT-FR](https://www.intercert-france.fr/wp-content/uploads/2025/06/fichereflexe-denideservice-endiguement.pdf)","severity":2,"severityLabel":"MEDIUM","tags":["ddos","deni-de-service","endiguement","reseau"],"flag":false,"customFields":[],"tasks":[{"_id":"~41439288","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220647,"title":"Mesure 1 â€” Ordonner vos actions et dÃ©terminer les mesures en fonction du dÃ©ni de service","group":"Endiguement","description":"### ğŸ¯ Objectif\nDÃ©terminer les actions prioritaires Ã  mettre en place en fonction du type de dÃ©ni de service.\n\n### ğŸ“Œ Actions\n- DÃ©terminer le pÃ©rimÃ¨tre et l'ordre des actions d'endiguement\n  * Commencer par le ou les Ã©lÃ©ments en amont du composant dÃ©faillant afin de rÃ©duire le trafic Ã  destination de ce dernier\n  * Terminer par le ou les composants dÃ©faillants afin de rÃ©duire la surcharge subie\n  * Appliquer les actions dâ€™endiguement de faÃ§on unitaire afin de juger de leur efficacitÃ© et de mesurer les Ã©ventuels effets de bord\n- SÃ©lectionner les actions d'endiguement en fonction du dÃ©ni de service (cf. fiche rÃ©flexe)\n   â†’ [DÃ©ni de service volumÃ©trique]\n   â†’ [DÃ©ni de service sur les protocoles]\n   â†’ [DÃ©ni de service sur les applications]\n   â†’ [DÃ©ni de service sur les services DNS]\n\n### âœ… Livrables\n+ Liste des actions d'endiguement ordonnancÃ©es renseignÃ©e dans les **activitÃ©s** de cette tÃ¢che","status":"Waiting","flag":false,"order":0,"mandatory":false,"extraData":{}},{"_id":"~41443384","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220664,"title":"Mesure 3 - Agir dans le pÃ©rimÃ¨tre de l'hÃ©bergeur","group":"Endiguement","description":"### ğŸ¯ Objectif\n**Adapter** les rÃ¨gles aux variations de lâ€™attaque au niveau de l'hÃ©bergeur.\n\n### ğŸ“Œ Actions\n- Activer le service anti-DDoS de lâ€™hÃ©bergeur (en amont du pare-feu et du routeur)\n\n  * Activer le service si disponible.\n\n  * Mettre Ã  jour rÃ¨gles de blocage et seuils de contrÃ´le de dÃ©bit selon les Ã©lÃ©ments discriminants issus de la qualification.\n\n  * Si disponible, activer les fonctions suivantes :\n\n    * Blocage des requÃªtes Ã  destination erronÃ©e (port non exposÃ©).\n\n    * Blocage par IP source malveillante via CTI.\n\n    * Blocage par dÃ©tection de robot (captcha dynamique ou challenge JavaScript).\n\n    * Blocage selon empreintes JA3/S et JA4.\n\n    * Autres fonctions anti-DDoS pertinentes.\n\n- Limiter les requÃªtes sur les Ã©quipements dâ€™infrastructure rÃ©seau\n\n  * RÃ©seau dâ€™administration\n    * Mettre en place une QoS pour prioriser le trafic dâ€™administration en cas dâ€™indisponibilitÃ©.\n\n  * Pare-feu\n\n    * Mettre Ã  jour le firmware si un DoS exploite une vulnÃ©rabilitÃ©.\n    * Durcir les rÃ¨gles pour limiter services et protocoles exposÃ©s. Rejeter le reste.\n    * Activer le blocage des paquets mal formÃ©s ou la protection DoS si possible.\n    * Bloquer selon les discriminants issus de la qualification (IP source, protocole, gÃ©olocalisation).\n    * Bloquer les IP sources rÃ©putÃ©es malveillantes (CTI).\n    * Filtrer par IP/bloc/AS/gÃ©olocalisation autorisÃ©s.\n    * Si services non essentiels ciblÃ©s, appliquer un blackhole temporaire sur les IP cibles. En parallÃ¨le, rÃ©tablir les services indirectement impactÃ©s selon leur importance.\n\n    * [DÃ©ni de service volumÃ©trique]\n\n      * Appliquer du rate limiting. DÃ©finir des seuils par IP source selon bande passante, paquets/s, requÃªtes avec signatures malveillantes.\n      * Superviser pour dÃ©tecter les effets de bord.\n      * Appliquer du traffic shaping pour prioriser certains flux.\n\n    * [DÃ©ni de service sur protocoles]\n\n      * RÃ©duire les durÃ©es de vie de suivi de connexions.\n      * Limiter les paquets SYN/s par IP source et par IP de destination.\n      * Activer SYN cookie.\n      * Poser des seuils ICMP/s et UDP/s par IP source.\n\n  *  Pare-feu applicatif (WAF)\n\n      * Mettre Ã  jour les signatures dâ€™attaque.\n      * Simplifier la configuration pour dÃ©charger les processeurs.\n      * [DÃ©ni de service volumÃ©trique] : rate limiting ou traffic shaping.\n      * [DÃ©ni de service applicatif]\n\n        * Bloquer les requÃªtes malveillantes par signatures.\n        * DÃ©finir des rÃ¨gles prÃ©cises sur les discriminants L7 observÃ©s. Ne pas appliquer sur des attaques volumÃ©triques majeures pour Ã©viter la surcharge CPU. \n      * Limiter les sessions cÃ´tÃ© services web.\n      * Activer le cache.\n      * DÃ©tection de robot (captcha dynamique ou challenge JavaScript).\n      * RÃ©duire les durÃ©es de vie de suivi de connexions.\n\n  * RÃ©partiteur de charge\n\n    * Appliquer du rate limiting.\n    * RÃ©duire les durÃ©es de vie de suivi de connexions.\n\n- Limiter les requÃªtes sur les ressources\n\n  * Hyperviseur\n\n    * Optimiser les ressources en cas de saturation.\n      * RÃ©partir la charge (crÃ©ation dâ€™instances).\n      * Allouer ou rÃ©allouer les ressources.\n      * SÃ©parer les instances par zones gÃ©ographiques (sharding).\n      * Mettre Ã  jour lâ€™hyperviseur.\n      * Migrer dâ€™autres machines pour libÃ©rer des ressources.\n      * Migrer la machine impactÃ©e pour relancer les autres services.\n\n  * Serveurs frontaux ou applicatifs\n\n    * SystÃ¨me saturÃ©\n\n      * Si lâ€™accÃ¨s est impossible : couper lâ€™accÃ¨s rÃ©seau de production, redÃ©marrer, appliquer les optimisations, rÃ©-ouvrir les flux.\n      * Allouer plus de ressources.\n      * Ajuster les seuils systÃ¨me limitants (ulimit, systemd).\n      * Optimiser bas niveau (sysctl Linux, System Resource Manager Windows).\n\n    * [DÃ©ni de service applicatif]\n\n      * DÃ©sactiver temporairement les fonctionnalitÃ©s non essentielles problÃ©matiques (moteur de recherche, formulaire).\n      * Limiter les sessions web.\n      * Activer le cache.\n      * DÃ©tection de robot (captcha dynamique ou challenge JavaScript).\n      * RÃ©duire les durÃ©es de vie de suivi de connexions.\n      * Optimiser la configuration web et composants (Apache, Nginx, IIS ; .NET, JRE ; Tomcat, JBoss, Node.js).\n      * Statifier les contenus peu changeants et dÃ©dier des serveurs.\n      * RedÃ©marrer les services en cas de processus bloquÃ© aprÃ¨s Ã©valuation dâ€™impact.\n\n  *  Serveurs de base de donnÃ©es\n\n      * [DÃ©ni de service applicatif]\n        * Optimiser ressources et configuration en cas de saturation.\n          * Ajouter des instances si le cluster le permet.\n\n\n### âœ… Livrables\n+ Tracer dans les **activitÃ©s** de cette tÃ¢che l'ensemble des actions rÃ©alisÃ©es.","status":"Waiting","flag":false,"order":2,"mandatory":false,"extraData":{}},{"_id":"~41447480","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220678,"title":"Mesure 5 - PrÃ©server les traces","group":"Endiguement","description":"### ğŸ¯ Objectif\nPrÃ©server les logs les plus anciens possibles.\n\n### ğŸ“Œ Actions\n- PrÃ©server les traces des journaux d'Ã©quipements\n- Exporter les logs des Ã©lÃ©ments cartographiÃ©s ou des captures manuelles du rÃ©seau\n\n### âœ… Livrables\n- Logs exportÃ©s et ajoutÃ©s Ã  l'incident","status":"Waiting","flag":false,"order":4,"mandatory":false,"extraData":{}},{"_id":"~82514032","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220683,"title":"ClÃ´ture & REX","group":"Endiguement","description":"### ğŸ¯ Objectif\nConsolider ce qui a fonctionnÃ©, planifier **durcissements**.\n\n### ğŸ“Œ Actions\n- Revue des seuils, *peacetime tuning*\n- Ajustements contrats/procÃ©dures\n\n### âœ… Livrables\nREX + backlog durcissement","status":"Waiting","flag":false,"order":5,"mandatory":false,"extraData":{}},{"_id":"~123396136","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220656,"title":"Mesure 2 â€”  Limiter le trafic en amont de l'entitÃ© (avec le FAI)","group":"Endiguement","description":"### ğŸ¯ Objectif\nÃ‰purer le trafic dans le pÃ©rimÃ¨tre du fournisseur dâ€™accÃ¨s internet (FAI) et limiter les requÃªtes vers lâ€™infrastructure de lâ€™entitÃ©. Ce type dâ€™endiguement sâ€™adresse plus particuliÃ¨rement lorsquâ€™un discriminant fort (exemples : IP source, protocole, etc.) a pu Ãªtre trouvÃ© dans la phase de qualification.\n\n### ğŸ“Œ Actions\n- Identifier un contact technique de votre FAI\n- Limiter le trafic en amont de l'entitÃ© (avec le FAI)\n- Activer le Service anti-DDoS du FAI\n\n### âœ… Livrables\n+ Limitation mis en place par le FAI\n+ Preuve de limitation du FAI ajoutÃ©e aux **activitÃ©s** de cette tÃ¢che","status":"Waiting","flag":false,"order":1,"mandatory":false,"extraData":{}},{"_id":"~123400232","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220673,"title":"Mesure 4 - Agir dans le pÃ©rimÃ¨tre des services dÃ©pendants","group":"Endiguement","description":"### ğŸ¯ Objectif\nAssurer la **rÃ©solution** DNS et les services vitaux.\n\n### ğŸ“Œ Actions\n- Agir sur les configurations du service DNS\n  * Filtrer les requÃªtes DNS malformÃ©es ou invalides\n  * Filtrer sur les enregistrements DNS qui nâ€™existent pas\n- Activer le CDN sur les attaques visant du contenu statique, si possible\n- Agir sur les composants tiers\n- Activer un service anti-DDoS externe, si possible\n\n### âœ… Livrables\n+ StabilitÃ© services clÃ©s\n+ Tracer dans les **activitÃ©s** de cette tÃ¢che les actions rÃ©alisÃ©es.","status":"Waiting","flag":false,"order":3,"mandatory":false,"extraData":{}}],"extraData":{"pageTemplateHeaders":[]}}