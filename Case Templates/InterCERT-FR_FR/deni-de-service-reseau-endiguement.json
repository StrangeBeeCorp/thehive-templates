{"_id":"~675888","_type":"CaseTemplate","_createdBy":"thehive@thehive.local","_updatedBy":"thehive@thehive.local","_createdAt":1755071155430,"_updatedAt":1757606627781,"name":"Déni de service réseau - Endiguement","displayName":"","description":"# 🌐 Déni de service réseau – Endiguement\n\n---\n\n## 🎯 Usage\nMettre en œuvre immédiatement les actions pour :  \n- Atténuer l’impact d’une attaque par déni de service réseau  \n- Maintenir l’accessibilité des services critiques  \n- Collaborer avec opérateurs et prestataires  \n- Préparer les mesures de durcissement \n \n---\n\n## ⚙️ Prérequis avant démarrage\n- ✅ Incident qualifié : confirmé comme déni de service malveillant (non incident de prod), gravité et caractéristiques établies  \n  → Fiche conseillée : *Déni de service réseau – Qualification*  \n- 🔑 Capacités d’administration disponibles (réseau, système, sécurité) et acteurs externes mobilisables  \n\n\n---\n\n## 📌 Objectifs\n\n### ✅ Sélectionner les actions appropriées\n1. Ordonner les actions dans le périmètre défini et sélectionner les mesures en fonction des caractéristiques de l’attaque  \n\n### ✅ Limiter les impacts\n2. Limiter le trafic en amont de l’entité (via le FAI)  \n3. Agir dans le périmètre de l’hébergeur  \n4. Agir dans le périmètre des services dépendants  \n\n### ✅ Préserver les traces\n5. Conserver les journaux et preuves  \n\n---\n\n## 📄 Ressource\n👉 [Fiche réflexe complète – INTERCERT-FR](https://www.intercert-france.fr/wp-content/uploads/2025/06/fichereflexe-denideservice-endiguement.pdf)","severity":2,"severityLabel":"MEDIUM","tags":["ddos","deni-de-service","endiguement","reseau"],"flag":false,"customFields":[],"tasks":[{"_id":"~41439288","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220647,"title":"Mesure 1 — Ordonner vos actions et déterminer les mesures en fonction du déni de service","group":"Endiguement","description":"### 🎯 Objectif\nDéterminer les actions prioritaires à mettre en place en fonction du type de déni de service.\n\n### 📌 Actions\n- Déterminer le périmètre et l'ordre des actions d'endiguement\n  * Commencer par le ou les éléments en amont du composant défaillant afin de réduire le trafic à destination de ce dernier\n  * Terminer par le ou les composants défaillants afin de réduire la surcharge subie\n  * Appliquer les actions d’endiguement de façon unitaire afin de juger de leur efficacité et de mesurer les éventuels effets de bord\n- Sélectionner les actions d'endiguement en fonction du déni de service (cf. fiche réflexe)\n   → [Déni de service volumétrique]\n   → [Déni de service sur les protocoles]\n   → [Déni de service sur les applications]\n   → [Déni de service sur les services DNS]\n\n### ✅ Livrables\n+ Liste des actions d'endiguement ordonnancées renseignée dans les **activités** de cette tâche","status":"Waiting","flag":false,"order":0,"mandatory":false,"extraData":{}},{"_id":"~41443384","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220664,"title":"Mesure 3 - Agir dans le périmètre de l'hébergeur","group":"Endiguement","description":"### 🎯 Objectif\n**Adapter** les règles aux variations de l’attaque au niveau de l'hébergeur.\n\n### 📌 Actions\n- Activer le service anti-DDoS de l’hébergeur (en amont du pare-feu et du routeur)\n\n  * Activer le service si disponible.\n\n  * Mettre à jour règles de blocage et seuils de contrôle de débit selon les éléments discriminants issus de la qualification.\n\n  * Si disponible, activer les fonctions suivantes :\n\n    * Blocage des requêtes à destination erronée (port non exposé).\n\n    * Blocage par IP source malveillante via CTI.\n\n    * Blocage par détection de robot (captcha dynamique ou challenge JavaScript).\n\n    * Blocage selon empreintes JA3/S et JA4.\n\n    * Autres fonctions anti-DDoS pertinentes.\n\n- Limiter les requêtes sur les équipements d’infrastructure réseau\n\n  * Réseau d’administration\n    * Mettre en place une QoS pour prioriser le trafic d’administration en cas d’indisponibilité.\n\n  * Pare-feu\n\n    * Mettre à jour le firmware si un DoS exploite une vulnérabilité.\n    * Durcir les règles pour limiter services et protocoles exposés. Rejeter le reste.\n    * Activer le blocage des paquets mal formés ou la protection DoS si possible.\n    * Bloquer selon les discriminants issus de la qualification (IP source, protocole, géolocalisation).\n    * Bloquer les IP sources réputées malveillantes (CTI).\n    * Filtrer par IP/bloc/AS/géolocalisation autorisés.\n    * Si services non essentiels ciblés, appliquer un blackhole temporaire sur les IP cibles. En parallèle, rétablir les services indirectement impactés selon leur importance.\n\n    * [Déni de service volumétrique]\n\n      * Appliquer du rate limiting. Définir des seuils par IP source selon bande passante, paquets/s, requêtes avec signatures malveillantes.\n      * Superviser pour détecter les effets de bord.\n      * Appliquer du traffic shaping pour prioriser certains flux.\n\n    * [Déni de service sur protocoles]\n\n      * Réduire les durées de vie de suivi de connexions.\n      * Limiter les paquets SYN/s par IP source et par IP de destination.\n      * Activer SYN cookie.\n      * Poser des seuils ICMP/s et UDP/s par IP source.\n\n  *  Pare-feu applicatif (WAF)\n\n      * Mettre à jour les signatures d’attaque.\n      * Simplifier la configuration pour décharger les processeurs.\n      * [Déni de service volumétrique] : rate limiting ou traffic shaping.\n      * [Déni de service applicatif]\n\n        * Bloquer les requêtes malveillantes par signatures.\n        * Définir des règles précises sur les discriminants L7 observés. Ne pas appliquer sur des attaques volumétriques majeures pour éviter la surcharge CPU. \n      * Limiter les sessions côté services web.\n      * Activer le cache.\n      * Détection de robot (captcha dynamique ou challenge JavaScript).\n      * Réduire les durées de vie de suivi de connexions.\n\n  * Répartiteur de charge\n\n    * Appliquer du rate limiting.\n    * Réduire les durées de vie de suivi de connexions.\n\n- Limiter les requêtes sur les ressources\n\n  * Hyperviseur\n\n    * Optimiser les ressources en cas de saturation.\n      * Répartir la charge (création d’instances).\n      * Allouer ou réallouer les ressources.\n      * Séparer les instances par zones géographiques (sharding).\n      * Mettre à jour l’hyperviseur.\n      * Migrer d’autres machines pour libérer des ressources.\n      * Migrer la machine impactée pour relancer les autres services.\n\n  * Serveurs frontaux ou applicatifs\n\n    * Système saturé\n\n      * Si l’accès est impossible : couper l’accès réseau de production, redémarrer, appliquer les optimisations, ré-ouvrir les flux.\n      * Allouer plus de ressources.\n      * Ajuster les seuils système limitants (ulimit, systemd).\n      * Optimiser bas niveau (sysctl Linux, System Resource Manager Windows).\n\n    * [Déni de service applicatif]\n\n      * Désactiver temporairement les fonctionnalités non essentielles problématiques (moteur de recherche, formulaire).\n      * Limiter les sessions web.\n      * Activer le cache.\n      * Détection de robot (captcha dynamique ou challenge JavaScript).\n      * Réduire les durées de vie de suivi de connexions.\n      * Optimiser la configuration web et composants (Apache, Nginx, IIS ; .NET, JRE ; Tomcat, JBoss, Node.js).\n      * Statifier les contenus peu changeants et dédier des serveurs.\n      * Redémarrer les services en cas de processus bloqué après évaluation d’impact.\n\n  *  Serveurs de base de données\n\n      * [Déni de service applicatif]\n        * Optimiser ressources et configuration en cas de saturation.\n          * Ajouter des instances si le cluster le permet.\n\n\n### ✅ Livrables\n+ Tracer dans les **activités** de cette tâche l'ensemble des actions réalisées.","status":"Waiting","flag":false,"order":2,"mandatory":false,"extraData":{}},{"_id":"~41447480","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220678,"title":"Mesure 5 - Préserver les traces","group":"Endiguement","description":"### 🎯 Objectif\nPréserver les logs les plus anciens possibles.\n\n### 📌 Actions\n- Préserver les traces des journaux d'équipements\n- Exporter les logs des éléments cartographiés ou des captures manuelles du réseau\n\n### ✅ Livrables\n- Logs exportés et ajoutés à l'incident","status":"Waiting","flag":false,"order":4,"mandatory":false,"extraData":{}},{"_id":"~82514032","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220683,"title":"Clôture & REX","group":"Endiguement","description":"### 🎯 Objectif\nConsolider ce qui a fonctionné, planifier **durcissements**.\n\n### 📌 Actions\n- Revue des seuils, *peacetime tuning*\n- Ajustements contrats/procédures\n\n### ✅ Livrables\nREX + backlog durcissement","status":"Waiting","flag":false,"order":5,"mandatory":false,"extraData":{}},{"_id":"~123396136","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220656,"title":"Mesure 2 —  Limiter le trafic en amont de l'entité (avec le FAI)","group":"Endiguement","description":"### 🎯 Objectif\nÉpurer le trafic dans le périmètre du fournisseur d’accès internet (FAI) et limiter les requêtes vers l’infrastructure de l’entité. Ce type d’endiguement s’adresse plus particulièrement lorsqu’un discriminant fort (exemples : IP source, protocole, etc.) a pu être trouvé dans la phase de qualification.\n\n### 📌 Actions\n- Identifier un contact technique de votre FAI\n- Limiter le trafic en amont de l'entité (avec le FAI)\n- Activer le Service anti-DDoS du FAI\n\n### ✅ Livrables\n+ Limitation mis en place par le FAI\n+ Preuve de limitation du FAI ajoutée aux **activités** de cette tâche","status":"Waiting","flag":false,"order":1,"mandatory":false,"extraData":{}},{"_id":"~123400232","_type":"Task","_createdBy":"thehive@thehive.local","_createdAt":1757522220673,"title":"Mesure 4 - Agir dans le périmètre des services dépendants","group":"Endiguement","description":"### 🎯 Objectif\nAssurer la **résolution** DNS et les services vitaux.\n\n### 📌 Actions\n- Agir sur les configurations du service DNS\n  * Filtrer les requêtes DNS malformées ou invalides\n  * Filtrer sur les enregistrements DNS qui n’existent pas\n- Activer le CDN sur les attaques visant du contenu statique, si possible\n- Agir sur les composants tiers\n- Activer un service anti-DDoS externe, si possible\n\n### ✅ Livrables\n+ Stabilité services clés\n+ Tracer dans les **activités** de cette tâche les actions réalisées.","status":"Waiting","flag":false,"order":3,"mandatory":false,"extraData":{}}],"extraData":{"pageTemplateHeaders":[]}}